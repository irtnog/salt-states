#### DEFAULTS.YAML --- Default settings for the SATOSA proxy states

satosa_proxy:
  base_url:
    http://localhost
  cookie_state_name:
    SATOSA_STATE
  state_encryption_key:
    ''
  backend_modules:
    - saml2_backend
  frontend_modules:
    - saml2_frontend
  micro_services:
    - static_attributes
  user_id_hash_salt:
    ''
  log_formatter:
    "[%(asctime)-19.19s] [%(levelname)-5.5s]: %(message)s"
  log_levels:
    satosa:
      INFO
  root_log_level:
    INFO

satosa_internal_attributes:
  attributes:
    address:
      openid: [address.street_address]
      orcid: [addresses.str]
      saml: [postaladdress]
    displayname:
      openid: [nickname]
      orcid: [name.credit-name]
      github: [login]
      saml: [displayName]
    edupersontargetedid:
      facebook: [id]
      linkedin: [id]
      orcid: [orcid]
      github: [id]
      openid: [sub]
      saml: [eduPersonTargetedID]
    givenname:
      facebook: [first_name]
      linkedin: [email-address]
      orcid: [name.given-names.value]
      openid: [given_name]
      saml: [givenName]
    mail:
      facebook: [email]
      linkedin: [email-address]
      orcid: [emails.str]
      github: [email]
      openid: [email]
      saml: [email, emailAdress, mail]
    name:
      facebook: [name]
      orcid: [name.credit-name]
      github: [name]
      openid: [name]
      saml: [cn]
    surname:
      facebook: [last_name]
      linkedin: [lastName]
      orcid: [name.family-name.value]
      openid: [family_name]
      saml: [sn, surname]
  hash: [edupersontargetedid]
  user_id_from_attrs: [edupersontargetedid]
  user_id_to_attr: edupersontargetedid

pysaml2_common_args:
  - entityid
  - xmlsec_binary
  - debug
  - key_file
  - cert_file
  - encryption_keypairs
  - additional_cert_files
  - metadata_key_usage
  - secret
  - accepted_time_diff
  - name
  - ca_certs
  - description
  - valid_for
  - verify_ssl_cert
  - organization
  - contact_person
  - name_form
  - virtual_organization
  - logger
  - only_use_keys_in_metadata
  - disable_ssl_certificate_validation
  - preferred_binding
  - session_storage
  - entity_category
  - xmlsec_path
  - extension_schemas
  - cert_handler_extra_class
  - generate_cert_func
  - generate_cert_info
  - verify_encrypt_cert_advice
  - verify_encrypt_cert_assertion
  - tmp_cert_file
  - tmp_key_file
  - validate_certificate
  - extensions
  - allow_unknown_attributes
  - crypto_backend

pysaml2_sp_args:
  - required_attributes
  - optional_attributes
  - idp
  - aa
  - subject_data
  - want_response_signed
  - want_assertions_signed
  - want_assertions_or_response_signed
  - authn_requests_signed
  - name_form
  - endpoints
  - ui_info
  - discovery_response
  - allow_unsolicited
  - ecp
  - name_id_format
  - name_id_format_allow_create
  - logout_requests_signed
  - requested_attribute_name_format
  - hide_assertion_consumer_service
  - force_authn
  - sp_type
  - sp_type_in_metadata
  - requested_attributes

pysaml2_aa_idp_args:
  - sign_assertion
  - sign_response
  - encrypt_assertion
  - encrypted_advice_attributes
  - encrypt_assertion_self_contained
  - want_authn_requests_signed
  - want_authn_requests_only_with_valid_cert
  - provided_attributes
  - subject_data
  - sp
  - scope
  - endpoints
  - metadata
  - ui_info
  - name_id_format
  - domain
  - name_qualifier
  - edu_person_targeted_id

####
#### SATOSA BACKENDS
####

satosa_saml2_backend:
  ## TODO: idp_blacklist
  certificate: ~
  key: ~
  organization:
    Example Identities
  organization_display_name:    # optional
    ''
  organization_url:
    https://www.example.com/
  support_contact:
    Example Identities Network Operations Center
  support_email:
    noc@example.com
  technical_contact:            # optional
    ''
  technical_email:
    ''
  metadata:
    local: []
    remote: []
  entityid:
    <base_url>/<name>/proxy_saml2_backend.xml
  accepted_time_diff:
    60
  want_response_signed:
    True
  endpoints:
    assertion_consumer_service:
      - [<base_url>/<name>/acs/post, 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST']
      - [<base_url>/<name>/acs/redirect, 'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect']
    discovery_response:
      - [<base_url>/<name>/disco, 'urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol']
  allow_unsolicited:
    True
  name_id_format:
    urn:oasis:names:tc:SAML:2.0:nameid-format:transient
  disco_srv:
    http://disco.example.com

####
#### SATOSA FRONTENDS
####

satosa_saml2_frontend:
  certificate: ~
  key: ~
  organization:
    Example Identities
  organization_display_name:    # optional
    ''
  organization_url:
    https://www.example.com/
  support_contact:
    Example Identities Network Operations Center
  support_email:
    noc@example.com
  technical_contact:            # optional
    ''
  technical_email:
    ''
  metadata:
    local: []
    remote: []
  entityid:
    <base_url>/<name>/proxy.xml
  accepted_time_diff:
    60
  name: Proxy IdP
  name_id_format:
    - 'urn:oasis:names:tc:SAML:2.0:nameid-format:persistent'
    - 'urn:oasis:names:tc:SAML:2.0:nameid-format:transient'
  policy:
    default:
      attribute_restrictions: null
      fail_on_missing_requested: false
      lifetime: {minutes: 15}
      name_form: urn:oasis:names:tc:SAML:2.0:attrname-format:uri
  acr_mapping:
    ## probably just examples and not recommended defaults
    # '': default-LoA
    # 'https://accounts.google.com': LoA1
    '': urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified
  endpoints:
    single_sign_on_service:
      'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST':
        sso/post
      'urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect':
        sso/redirect

####
#### SATOSA MICRO SERVICES
####

satosa_aws_attribute_release:
  aws_entity_ids:
    - urn:amazon:webservices
    - urn:amazon:webservices:govcloud
  role_session_name_source:
    name
  session_duration:
    ~
  ## additional keys describe AWS accounts, e.g.:
  # 123456789012:                 # the AWS account ID (required)
  #   default:                    # this account's defaults (optional)
  #     ## Obtain values for the AWS Role attribute from this SATOSA
  #     ## internal attribute (defaults to "ismemberof").
  #     role_source:
  #       ismemberof
  #     ## This regexp limits which role values get emitted (defaults to
  #     ## ".*").
  #     role_source_filter:
  #       '.*'
  #     ## Specify the ID of this account's IAM identity provider
  #     ## corresponding to this service (defaults to "SATOSA").
  #     saml_provider_name:
  #       SATOSA
  #   ## override the above defaults for this audience
  #   urn:amazon:webservices:govcloud:
  #     role_source_filter:
  #       'GovCloud-.*'
  # 234567890123:                 # another AWS account, using all defaults
  #   {}
  # 345678901234: &my-common-settings
  #   default:
  #     saml_provider_name:
  #       My-IdP-Proxy
  # 456789012345:                 # shares its config with the above account
  #   <<: *my-common-settings
  #   urn:amazon:webservices:
  #     role_source_filter:
  #       'OnlyThisGroup'         # overrides just this bit of the shared config

satosa_ldap_attribute_store:
  default:
    ignore:
      no
    ldap_url:                   # required
      ''
    bind_dn:                    # required
      ''
    bind_password:              # required
      ''
    search_base:
      ~
    pool_size:
      10
    pool_keepalive:
      10
    ldap_identifier_attribute:
      uid
    ordered_identifier_candidates:
      - attribute_names: [epuid]
      - attribute_names: [eppn, name_id]
        name_id_format: urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
      - attribute_names: [eppn, edupersontargetedid]
      - attribute_names: [eppn]
      - attribute_names: [name_id]
        name_id_format: urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
        add_scope: issuer_entityid
      - attribute_names: [edupersontargetedid]
        add_scope: issuer_entityid
    search_return_attributes:
      sn: surname
      givenName: givenname
      mail: mail
      employeeNumber: employeenumber
      isMemberOf: ismemberof
    user_id_from_attrs:
      - employeeNumber
    clear_input_attributes:
      no
    on_ldap_search_result_empty:
      ~

#### DEFAULTS.YAML ends here.
