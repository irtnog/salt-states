ssh:
  packages:
    []
  config_directory:
    /etc/ssh

  ## sometimes, GitHub needs diffie-hellman-group-exchange-sha1
  Host github.com:
    KexAlgorithms:
      - curve25519-sha256@libssh.org
      - diffie-hellman-group-exchange-sha256
      - diffie-hellman-group-exchange-sha1
      - diffie-hellman-group14-sha1

  Host *:
    ## eliminate key exchange protocols that use NIST curves, have too
    ## small a DH modulus, or use an insecure hash function, while
    ## still maintaining a degree of backward compatibility
    KexAlgorithms:
      - curve25519-sha256@libssh.org
      - diffie-hellman-group-exchange-sha256

    ## explicitly enable public key authentication
    PubkeyAuthentication: yes

    ## disable the DSA and ECDSA server authentication algorithms,
    ## which depend on the quality/integrity of the PRNG to prevent
    ## key recovery attacks; DSA also requires 1024-bit keys, which
    ## are too small
    HostKeyAlgorithms:
      - ssh-ed25519-cert-v01@openssh.com
      - ssh-rsa-cert-v01@openssh.com
      - ssh-ed25519
      - ssh-rsa

    ## eliminate broken ciphers, key sizes less than 128 bits, and
    ## block ciphers with block sizes smaller than 128 bits; prefer AE
    ## modes but allow CTR for backwards compatibility (CTR with
    ## Encrypt-then-MAC is provably secure), and prefer
    ## ChaCha20+Poly1305 over the others because it encrypts message
    ## sizes (which prevents certain kinds of encrypted traffic
    ## analysis attacks)
    Ciphers:
      - chacha20-poly1305@openssh.com
      - aes256-gcm@openssh.com
      - aes128-gcm@openssh.com
      - aes256-ctr
      - aes192-ctr
      - aes128-ctr

    ## only use Encrypt-then-MAC with strong hash algorithms; also
    ## enforce minimum tag and key sizes of 128 bits
    MACs:
      - hmac-sha2-512-etm@openssh.com
      - hmac-sha2-256-etm@openssh.com
      - hmac-ripemd160-etm@openssh.com
      - umac-128-etm@openssh.com
      - hmac-sha2-512
      - hmac-sha2-256
      - hmac-ripemd160
      - umac-128@openssh.com

    ## disable undocumented, rarely used feature with known bugs
    UseRoaming: no
