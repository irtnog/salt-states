{%- from "apache/map.jinja" import apache_settings with context -%}
{%- from "apache/lib.jinja" import render_apache_config with context -%}
{%- if 'module_id' in apache_settings.modules[module] -%}
  {%- set module_id = apache_settings.modules[module].module_id -%}
{%- else -%}
  {%- set module_id = '%s_module'|format(module) -%}
{%- endif -%}
{%- if 'module_filename' in apache_settings.modules[module] -%}
  {%- set module_filename = apache_settings.modules[module].module_filename -%}
{%- else -%}
  {%- set module_filename = '%s%s%s'|format(apache_settings.module_prefix, module, apache_settings.module_suffix) -%}
{%- endif -%}

<IfModule !{{ module_id }}>
LoadModule {{ module_id }} {{ module_filename }}
</IfModule>

{{ render_apache_config(apache_settings.modules[module]) }}
